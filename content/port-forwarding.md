+++
date = "2017-11-16T20:26:24+08:00"
menu = "main"
title = "端口转发"
weight = 20
+++

GOST从2.1版本开始增加了对端口转发的支持，端口转发有四种类型

## TCP本地端口转发

将本地的TCP端口A映射到指定的目标TCP端口B，所有到端口A的数据会被转发到端口B。此功能类似于SSH的本地端口转发功能。

```bash
gost -L=tcp://:2222/192.168.1.1:22 [-F=..]
```

将本地TCP端口2222上的数据(通过代理链)转发到192.168.1.1:22上。

当代理链末端(最后一个-F参数)为`forward+ssh`类型时，GOST会直接使用SSH的本地端口转发功能:

```bash
gost -L=tcp://:2222/192.168.1.1:22 -F forward+ssh://:2222
```

## TCP远程端口转发

将目标TCP端口B映射到本地TCP端口A，所有到端口B上的数据会被转发到端口A。此功能类似于SSH的远程端口转发功能。

```bash
gost -L=rtcp://:2222/192.168.1.1:22 [-F=... -F=socks5://172.24.10.1:1080]
```

将172.24.10.1:2222上的数据(通过代理链)转发到192.168.1.1:22上。

当代理链末端(最后一个-F参数)为`forward+ssh`类型时，GOST会直接使用SSH的远程端口转发功能:

```bash
gost -L=rtcp://:2222/192.168.1.1:22 -F forward+ssh://:2222
```

## UDP本地端口转发

将本地的UDP端口A映射到指定的目标UDP端口B，所有到端口A的数据会被转发到端口B。

```bash
gost -L=udp://:5353/192.168.1.1:53?ttl=60 [-F=... -F=socks5://172.24.10.1:1080]
```

将本地UDP端口5353上的数据(通过代理链)转发到192.168.1.1:53上。 

每一个不同的客户端(不同的端口)对应一条转发通道，每条转发通道都有超时时间，当超过此时间且在此时间段内无任何数据交互，则此通道将关闭。
可以通过`ttl`参数来设置超时时间，默认值为60秒。

## UDP远程端口转发

将目标UDP端口B映射到本地UDP端口A，所有到端口B上的数据会被转发到端口A。

```bash
gost -L=rudp://:5353/192.168.1.1:53?ttl=60 [-F=... -F=socks5://172.24.10.1:1080]
```

将172.24.10.1:5353上的数据(通过代理链)转发到192.168.1.1:53上。 

每一个不同的客户端(不同的端口)对应一条转发通道，每条转发通道都有超时时间，当超过此时间且在此时间段内无任何数据交互，则此通道将关闭。
可以通过`ttl`参数来设置超时时间，默认值为60秒。


{{< admonition title="注意" type="warning" >}}
转发UDP数据时，如果有代理链，则代理链的末端(最后一个-F参数)必须是GOST SOCKS5类型代理，GOST会使用UDP-over-TCP方式进行转发。
{{< /admonition >}}

