+++
date = "2018-5-19T20:12:00+08:00"
menu = "main"
title = "路由控制"
weight = 80
+++

GOST在2.6版本中增加了路由控制功能，可以通过黑白名单来控制请求的客户端和请求代理链。路由控制可以应用于服务节点和代理链的所有层级节点。

## 客户端权限控制

当应用于本地服务节点时(-L参数)，可以用来控制客户端的访问权限：

```bash
gost -L=:8080?bypass=192.168.1.1,172.10.0.0/16
```

服务端通过`bypass`参数来指定客户端列表(以逗号分割的IP或CIDR地址)，所有此列表中的客户端都被禁止访问此服务(黑名单)。

若地址比较多，可以使用外部配置文件：

```bash
gost -L=:8080?bypass=bypass.txt
```

配置文件的格式为(按行分割的地址列表)：

```text
192.168.1.1
172.10.0.0/16
```

若要转换为白名单，则通过在`bypass`参数值前添加`~`前缀：

```bash
gost -L=:8080?bypass=~192.168.1.1,172.10.0.0/16
```

对于文件方式也是一样：

```bash
gost -L=:8080?bypass=~bypss.txt
```

## 请求路径控制

当应用于代理链节点时(-F参数)，可以用来控制请求的代理链路径：

```bash
gost -L :8080 -F :1080?bypass=127.0.0.1,172.10.0.0/16,localhost,*.example.com
```

客户端通过`bypass`参数来指定请求的目标地址列表(以逗号分割的IP,CIDR,域名或域名通配符地址)。

当客户端执行代理链的节点选择时，每当确定一个代理链层级节点后，会应用此节点上的路由配置(`bypass`参数)，若此次请求的目标地址包含在此配置中，则代理链终止于此节点(且不包含此节点)。

若地址比较多，可以使用外部配置文件：

```bash
gost -L :8080 -F :1080?bypass=bypass.txt
```

配置文件的格式为(按行分割的地址列表)：

```text
127.0.0.1
172.10.0.0/16
localhost
*.example.com
```

若要转换为白名单，则通过在`bypass`参数值前添加`~`前缀：

```bash
gost -L=:8080?bypass=~127.0.0.1,172.10.0.0/16,localhost,*.example.com
```

对于文件方式也是一样：

```bash
gost -L=:8080?bypass=~bypss.txt
```